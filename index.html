<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<link href="https://fonts.googleapis.com/css?family=Jua&display=swap" rel="stylesheet">
	<title>ì§ì„ ë§ì¶°ë</title>
		<style type="text/css">
			html{cursor: url(face1.png), auto}
			body{font-family: 'Jua', sans-serif;}
        .width500px{width: 550px; display: inline-block;}
        .center{text-align: center;}
        .alignRight{ font-size: 32px; }
        #back{background: url(./back.png); background-size: cover; background-attachment: fixed;}
        #menuTable{ font-size: 22px; }
        #startBtn{border: none; color: white; background-color: #79D8B6; width: 100px;padding: 7px; font-family: 'Jua', sans-serif; font-weight: bold; font-size: 22px;  margin-bottom: 10px; cursor: url(face1.png), auto}
        #cardTable{border-collapse: collapse;}
        #cardTable td{border: 1px solid #79D8B6; width: 90px; height: 121px; text-align: center;}
        #cardTable td img{max-width: 85px;}
        #cardTable td span{font-size: 25pt; font-weight: bold; color: #79D8B6; display: none;}
        #countDown{background-color: #79D8B6; color: white; font-size: 20pt; padding: 5px;}
        #info{width: 550px; height: 270px; background-color: #DDDDDD; color: white; padding-top: 230px;}
		</style>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		
</head>
  <body class='center' id="back">
        <div class='width500px'>
            <div>
                <h1>ğŸ¤“ ê°™ì€ ì¹œêµ¬ë¥¼ ì°¾ì•„ë! ğŸ¤“</h1>
               
                <table id='menuTable'>
                    <tr>
                        <td class='alignLeft'>
                            <button id='startBtn'>start</button>
                            <audio loop id="song">
        					<source src="song.mp3" type="audio/mpeg"></audio>
                        </td>
                        <td class='alignRight'>
                            <span>&nbsp;SCORE : <span id='score'>0</span></span>
                        </td>
                    </tr>
                </table>
            </div>
            <div>
                <div id='countDown'>
                    ready
                </div>
                <table id='cardTable'>
                </table>
                <div id='info'>
                    start ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”<br>
                </div>
            </div>
        </div>

        <script type="text/javascript">
            // ê²Œì„ ìƒíƒœ
            var gameState = '';
 
            // ì—´ë¦° ì¹´ë“œ src
            var openCardId = '';
            var openCardId2 = '';
 
            // ë‚œìˆ˜ ìƒì„± í•¨ìˆ˜
            function generateRandom (min, max) {
                var ranNum = Math.floor(Math.random()*(max-min+1)) + min;
                    return ranNum;
            }
 
            
            var cards; // ì¹´ë“œ ëª©ë¡
            var score = 0; // ì ìˆ˜
            var openedCtn = 0; // ë§ì¶˜ ì¹´ë“œ ê°¯ìˆ˜
            
            // ì¹´ë“œ ë°°ì¹˜
            function setTable(){
                cards = [
                './1.png','./1.png', // ë‚˜ì˜¹ì´
                './2.png','./2.png', // íŒŒì´ë¦¬
                './14.png','./14.png', // ê¼¬ë¶€ê¸°
                './4.png','./4.png', // ì´ìƒí•´ì”¨
                './5.png','./5.png', // ì–´ë‹ˆë¶€ê¸°
                './6.png','./6.png', // ì‰ì–´í‚¹
                './7.png','./7.png', // í‘¸ë¦°
                './8.png','./8.png', // í”¼ì¹´ì¸„
                './9.png','./9.png', // ë³„ê°€ì‚¬ë¦¬
                './10.png','./10.png', // ê±°ë¶ì™•
                './11.png','./11.png', // ê³ ë¼íŒŒë•
                './16.png','./16.png' // ë¦¬ìë“œ
                ];
                var cardTableCode = '<tr>';                
                for(var i=0;i<24;i++) {
                    if(i>0 && i%6 == 0){
                        cardTableCode += '</tr><tr>';
                    }
                    var idx = generateRandom(0,23-i);
                    var img = cards.splice(idx,1);
 
                    cardTableCode += '<td id="card'+i+'"><img src="'+img+'"><span>?</span></td>';
                }
                cardTableCode += '</tr>';
                $('#cardTable').html(cardTableCode);
            }
 
            // ì¹´ë“œ ì „ì²´ ê°€ë¦¬ê¸°
            function hiddenCards(){
                $('#cardTable td img').hide();
                $('#cardTable td span').show();
            }
 
            // ê²Œì„ ì‹œì‘
            function startGame() {
                var sec = 6;
                
                $('#info').hide(); // ì•ˆë‚´ ë¬¸êµ¬ ê°€ë¦¬ê¸°
                scoreInit(); // ì ìˆ˜ ì´ˆê¸°í™”
                setTable(); // ì¹´ë“œ ë°°ì¹˜

               
                song.play();
               
                
                //ì¹´ìš´íŠ¸ ë‹¤ìš´
                function setText(){
                    $('#countDown').text(--sec);
                }
 
                //ì¹´ìš´íŠ¸ ë‹¤ìš´
                var intervalID = setInterval(setText, 1000);
                setTimeout(function(){
                    clearInterval(intervalID);
                    $('#countDown').text('start');
                    hiddenCards();
                    gameState = '';
                }, 6000);
            }
 
 
            // ì¹´ë“œ ì„ íƒ ì‹œ
            $(document).on('click', '#cardTable td', function(){
                if(gameState != '') return; // ê²Œì„ ì¹´ìš´íŠ¸ ë‹¤ìš´ì¤‘ì¼ ë•Œ ëˆ„ë¥¸ ê²½ìš° return
                if(openCardId2 != '') return; // 2ê°œ ì—´ë ¤ìˆëŠ”ë° ë˜ ëˆ„ë¥¸ ê²½ìš° return
                if($(this).hasClass('opened')) return; // ì—´ë ¤ìˆëŠ” ì¹´ë“œë¥¼ ë˜ ëˆ„ë¥¸ ê²½ìš°                
                $(this).addClass('opened'); // ì—´ì—¬ìˆë‹¤ëŠ” ê²ƒì„ êµ¬ë¶„í•˜ê¸° ìœ„í•œ class ì¶”ê°€
 
                if(openCardId == '') {
                    $(this).find('img').show();
                    $(this).find('span').hide();
                    openCardId = this.id;
                }else {
                    if(openCardId == openCardId2) return; //ê°™ì€ ì¹´ë“œ ëˆ„ë¥¸ ê²½ìš° return
 
                    $(this).find('img').show();
                    $(this).find('span').hide();
                    
                    var openCardSrc = $('#'+openCardId).find('img').attr('src');
                    var openCardSrc2 = $(this).find('img').attr('src');
                    openCardId2 = this.id;
                    
                    if(openCardSrc == openCardSrc2) { // ì¼ì¹˜
                        openCardId = '';
                        openCardId2 = '';
                        scorePlus();
                        if(++openedCtn == 12){
                            alert('ì„±ê³µ!!\n'+score+'ì  ì…ë‹ˆë‹¤!');
                        }
                    }else { // ë¶ˆì¼ì¹˜
                        setTimeout(back, 1000);
                        scoreMinus();
                    }
                }
            });
 
            // ë‘ê°œì˜ ì¹´ë“œ ë‹¤ì‹œ ë’¤ì§‘ê¸°
            function back() {
                $('#'+openCardId).find('img').hide();
                $('#'+openCardId).find('span').show();
                $('#'+openCardId2).find('img').hide();
                $('#'+openCardId2).find('span').show();
                $('#'+openCardId).removeClass('opened');
                $('#'+openCardId2).removeClass('opened');
                openCardId = '';
                openCardId2 = '';
            }
 
            // ì ìˆ˜ ì´ˆê¸°í™”
            function scoreInit(){
                score = 0;
                openedCtn = 0;
                $('#score').text(score);
            }
            // ì ìˆ˜ ì¦ê°€
            function scorePlus(){
                score += 15;
                $('#score').text(score);
            }
            // ì ìˆ˜ ê°ì†Œ
            function scoreMinus(){
                score -= 5;
                $('#score').text(score);
            }
 
            $(document).on('click', '#startBtn', function(){
                if(gameState == '') {
                    startGame();
                    gameState = 'alreadyStart'
                }
            });
        </script>
    </body>
</html>